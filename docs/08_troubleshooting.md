# トラブルシューティングガイド

**バグに遭遇したら、このページを見てください！**

症状から原因を特定し、解決する手順を示します。

---

## 🎯 クイック診断

**まず、あなたの問題はどれですか？**

| 症状 | 確認すべきパネル | ジャンプ先 |
|------|------------------|-----------|
| **エラーメッセージが出ている** | Console | [→エラーメッセージの対処](#1-エラーメッセージが出ている) |
| **画面に何も表示されない** | Elements / Console | [→画面表示の問題](#2-画面に何も表示されない) |
| **ボタンやリンクが動かない** | Console / Elements | [→イベントの問題](#3-ボタンやリンクが動かない) |
| **画像が表示されない** | Network | [→画像の問題](#4-画像が表示されない) |
| **CSS が効かない** | Elements | [→CSS の問題](#5-css-が効かない) |
| **API 通信が失敗する** | Network / Console | [→API の問題](#6-api-通信が失敗する) |
| **計算結果がおかしい** | Sources / Console | [→ロジックの問題](#7-計算結果やロジックがおかしい) |
| **ページが真っ白** | Console | [→致命的エラー](#8-ページが真っ白何も表示されない) |
| **レイアウトが崩れている** | Elements | [→レイアウトの問題](#9-レイアウトが崩れている) |
| **ページが遅い** | Network / Performance | [→パフォーマンスの問題](#10-ページの読み込みが遅い) |

---

## 1. エラーメッセージが出ている

### 📋 確認手順

```
┌────────────────────────────────────────┐
│ ステップ1: Console を開く               │
│ ショートカット: Ctrl + Shift + J       │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ2: 赤色のエラーを探す           │
│ ❌ Uncaught TypeError: ...             │
│ ❌ ReferenceError: ...                 │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ3: エラーの種類を確認           │
│ • ReferenceError → 変数が未定義        │
│ • TypeError → null/undefined エラー   │
│ • SyntaxError → 構文エラー            │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ4: ファイル名と行番号をクリック │
│ script.js:15 をクリック                │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ5: Sources パネルで該当行を確認│
│ 問題のコードを特定                      │
└────────────────────────────────────────┘
```

### 🔍 よくあるエラーと解決法

#### `ReferenceError: XXX is not defined`

**原因：** 変数や関数 `XXX` が定義されていない

**確認：**
1. スペルミスがないか確認
2. JavaScript ファイルの読み込み順序を確認（HTML で）
3. Console で `typeof XXX` を実行 → `undefined` なら定義されていない

**解決：**
```javascript
// 間違い
consol.log("Hello");  // ❌ consol → console

// 正しい
console.log("Hello");  // ✅
```

---

#### `TypeError: Cannot read property 'XXX' of null`

**原因：** `null` または `undefined` のプロパティを読もうとした

**確認：**
```javascript
// Console で確認
let element = document.querySelector('.my-button');
console.log(element);  // null なら要素が見つかっていない
```

**解決：**
```javascript
// 方法1: 存在チェック
if (element) {
  element.addEventListener('click', () => {});
}

// 方法2: オプショナルチェイニング
element?.addEventListener('click', () => {});
```

**さらに確認：**
- Elements パネルで要素が存在するか確認
- セレクタが正しいか確認（`.my-button` のスペル）
- JavaScript の実行タイミングを確認（DOMContentLoaded より前か）

---

#### `SyntaxError: Unexpected token`

**原因：** コードの書き方が間違っている

**確認：**
- 括弧が閉じられているか（`{`, `}`, `(`, `)`, `[`, `]`）
- カンマやセミコロンの位置
- 引用符が閉じられているか（`"`, `'`, `` ` ``）

**解決：**
- エディタの構文チェック機能を使う
- コード整形ツール（Prettier）を使う

---

## 2. 画面に何も表示されない

### 📋 確認手順

```
┌────────────────────────────────────────┐
│ ステップ1: Console でエラーを確認       │
│ 赤いエラーがある？                      │
└────────────────────────────────────────┘
      YES ↓         NO →（次へ）
┌────────────────────────────────────────┐
│ → [1. エラーメッセージの対処] へ        │
└────────────────────────────────────────┘

┌────────────────────────────────────────┐
│ ステップ2: Elements パネルで確認        │
│ HTML が存在するか確認                   │
└────────────────────────────────────────┘
      要素がある ↓   要素がない →（原因: JavaScript で追加されていない）
┌────────────────────────────────────────┐
│ ステップ3: CSS を確認                   │
│ • display: none になっていないか        │
│ • visibility: hidden になっていないか   │
│ • opacity: 0 になっていないか           │
│ • color と background が同じ色でないか │
└────────────────────────────────────────┘
```

### 🔍 確認ポイント

#### Elements パネルで要素を選択 → Styles パネルで確認

```css
/* よくある原因 */
.my-element {
  display: none;        /* ← 非表示になっている */
  visibility: hidden;   /* ← 非表示になっている */
  opacity: 0;           /* ← 透明になっている */
  width: 0;             /* ← サイズが0 */
  height: 0;            /* ← サイズが0 */
}
```

#### Console で確認

```javascript
// 要素が存在するか
let element = document.querySelector('.my-element');
console.log(element);  // null なら存在しない

// スタイルを確認
console.log(window.getComputedStyle(element).display);
```

---

## 3. ボタンやリンクが動かない

### 📋 確認手順

```
┌────────────────────────────────────────┐
│ ステップ1: ボタンをクリックして         │
│            Console を確認               │
└────────────────────────────────────────┘
      エラーが出る ↓   何も出ない →（次へ）
┌────────────────────────────────────────┐
│ → エラーメッセージを読む                │
│   [1. エラーメッセージの対処] へ        │
└────────────────────────────────────────┘

┌────────────────────────────────────────┐
│ ステップ2: イベントリスナーが           │
│            設定されているか確認          │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ Elements パネルで要素を選択             │
│ → Event Listeners タブを開く            │
│   click イベントがあるか確認            │
└────────────────────────────────────────┘
      ある ↓         ない →（原因: イベントリスナーが設定されていない）
┌────────────────────────────────────────┐
│ ステップ3: イベント内のコードを確認     │
│ Sources パネルでブレークポイント        │
└────────────────────────────────────────┘
```

### 🔍 確認ポイント

#### Console で確認

```javascript
// 要素が取得できているか
let button = document.querySelector('.my-button');
console.log(button);  // null なら要素が見つかっていない

// イベントリスナーが設定されているか（デバッグ用）
button.addEventListener('click', () => {
  console.log('ボタンがクリックされた！');  // これが出ればイベントは動いている
});
```

#### Sources パネルでデバッグ

1. イベントハンドラーの中にブレークポイントを設定
2. ボタンをクリック
3. 止まらない → イベントリスナーが設定されていない
4. 止まる → Step Over (F10) で進めて、どこで問題が起きるか確認

---

## 4. 画像が表示されない

### 📋 確認手順

```
┌────────────────────────────────────────┐
│ ステップ1: Network パネルを開く         │
│ → ページをリロード (F5)                │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ2: Img フィルタを選択           │
│ 画像ファイルを探す                      │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ3: Status を確認                │
│ • 404 → ファイルが見つからない          │
│ • 403 → アクセス権限がない              │
│ • 200 → 正常に読み込まれている          │
└────────────────────────────────────────┘
      404の場合 ↓
┌────────────────────────────────────────┐
│ ステップ4: ファイルパスを確認           │
│ Name をクリック → Headers タブ          │
│ Request URL を確認                      │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ5: 実際のファイル構造と比較     │
│ パスが正しいか確認                      │
└────────────────────────────────────────┘
```

### 🔍 よくある原因

#### パスが間違っている

```html
<!-- プロジェクト構造 -->
<!--
├── index.html
├── images/
│   └── logo.png
-->

<!-- 間違い -->
<img src="logo.png">              ❌ images フォルダがない
<img src="/logo.png">             ❌ ルートにはない

<!-- 正しい -->
<img src="./images/logo.png">     ✅
<img src="images/logo.png">       ✅
```

#### ファイル名の大文字・小文字

```html
<!-- ファイル名: Logo.png -->
<img src="logo.png">  ❌ 小文字で書いている（サーバーでエラーになる）
<img src="Logo.png">  ✅ 正しい
```

#### Status 200 なのに表示されない

→ CSS の問題の可能性

```css
img {
  display: none;  /* ← CSS で非表示になっている */
  width: 0;       /* ← サイズが0 */
}
```

---

## 5. CSS が効かない

### 📋 確認手順

```
┌────────────────────────────────────────┐
│ ステップ1: Elements パネルで要素を選択  │
│ Ctrl + Shift + C → 要素をクリック      │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ2: Styles パネルで CSS を確認   │
│ 自分の CSS が表示されているか           │
└────────────────────────────────────────┘
      表示されている ↓    表示されていない →（原因: セレクタが間違っている）
┌────────────────────────────────────────┐
│ ステップ3: 取り消し線を確認             │
│ 取り消し線 → 他の CSS に上書きされている│
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ4: Computed タブで確認          │
│ 最終的な値を確認                        │
└────────────────────────────────────────┘
```

### 🔍 よくある原因

#### 1. セレクタが間違っている

```css
/* HTML: <div class="my-box">...</div> */

/* 間違い */
.mybox { }     ❌ ハイフンがない
#my-box { }    ❌ class なのに id セレクタ

/* 正しい */
.my-box { }    ✅
```

**確認方法：**
- Elements パネルで要素を選択
- Styles パネルに自分の CSS が表示されるか確認
- 表示されない → セレクタが間違っている

---

#### 2. CSS ファイルが読み込まれていない

**確認：**
1. Network パネル → CSS フィルタ
2. 自分の CSS ファイルが表示されるか
3. Status が 404 → ファイルパスが間違っている

```html
<!-- HTML で確認 -->
<link rel="stylesheet" href="style.css">  <!-- パスが正しいか -->
```

---

#### 3. 他の CSS に上書きされている

**確認：**
- Styles パネルで取り消し線があるか確認

```css
/* Styles パネルの表示例 */
.my-box {
  color: red;    /* ← 取り消し線がある → 無効 */
}

.my-box {
  color: blue;   /* ← こちらが適用されている */
}
```

**解決：**
- セレクタの詳細度を上げる
- `!important` を使う（最終手段）

```css
/* 詳細度を上げる */
div.my-box {
  color: red;
}

/* または */
.my-box {
  color: red !important;  /* 強制的に適用 */
}
```

---

#### 4. キャッシュの問題

**確認：**
- Network パネルで **Disable cache** にチェック
- `Ctrl + Shift + R` で強制リロード

---

## 6. API 通信が失敗する

### 📋 確認手順

```
┌────────────────────────────────────────┐
│ ステップ1: Network パネルを開く         │
│ → Fetch/XHR フィルタを選択             │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ2: API リクエストを探す         │
│ 該当するリクエストをクリック             │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ3: Status を確認                │
│ • 200 → 成功                           │
│ • 404 → URL が間違っている             │
│ • 500 → サーバーエラー                 │
│ • CORS error → CORS 設定が必要         │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ4: Headers タブを確認           │
│ • Request URL: 正しい URL か           │
│ • Request Method: GET/POST が正しいか  │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ5: Response タブを確認          │
│ サーバーからのエラーメッセージを読む     │
└────────────────────────────────────────┘
```

### 🔍 よくあるエラー

#### Status 404: Not Found

**原因：** URL が間違っている

**確認：**
- Headers タブで Request URL を確認
- API ドキュメントと比較

```javascript
// 間違い
fetch('https://api.example.com/user');  // ❌ users が複数形のはず

// 正しい
fetch('https://api.example.com/users'); // ✅
```

---

#### CORS エラー

**Console のエラー：**
```
Access to fetch at 'https://api.example.com' from origin 'http://localhost:3000'
has been blocked by CORS policy
```

**原因：** サーバー側で CORS が設定されていない

**確認：**
1. Network パネルで該当リクエストをクリック
2. Headers タブ → Response Headers
3. `Access-Control-Allow-Origin` があるか確認

**解決：**
- サーバー側で CORS 設定を追加する必要がある
- 開発環境なら、プロキシ設定で回避可能

---

#### Status 500: Internal Server Error

**原因：** サーバー側のエラー

**確認：**
1. Response タブでエラーメッセージを確認
2. Payload タブ（POST の場合）で送信データを確認

**デバッグ：**
```javascript
fetch('/api/users', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ name: 'Taro', age: 25 })
})
.then(res => {
  console.log('Status:', res.status);  // ← ステータスコードを確認
  return res.json();
})
.then(data => console.log(data))
.catch(err => console.error('エラー:', err));  // ← エラーをキャッチ
```

---

## 7. 計算結果やロジックがおかしい

### 📋 確認手順

```
┌────────────────────────────────────────┐
│ ステップ1: console.log() で値を確認     │
│ 変数の中身を出力                        │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ2: Sources パネルでブレーク     │
│ 問題がありそうな場所にブレークポイント   │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ3: Step Over (F10) で進める    │
│ 1行ずつ実行して変数を確認               │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ4: Scope パネルで変数を確認     │
│ 期待した値になっているか                │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ5: 原因を特定 → 修正            │
└────────────────────────────────────────┘
```

### 🔍 よくある原因

#### 型の問題

```javascript
let price = "1000";     // ← 文字列
let quantity = 3;
let total = price * quantity;
console.log(total);     // 3000 （なぜか動く...）

// しかし...
let total2 = price + quantity;
console.log(total2);    // "10003" ← 文字列結合になる！
```

**確認：**
```javascript
console.log(typeof price);  // "string"
```

**解決：**
```javascript
let price = Number("1000");  // 数値に変換
```

---

#### 変数のスコープ

```javascript
function test() {
  if (true) {
    var x = 10;  // var はスコープが広い
    let y = 20;  // let はブロックスコープ
  }
  console.log(x);  // 10 （アクセスできる）
  console.log(y);  // ReferenceError （アクセスできない）
}
```

**デバッグ：**
- Sources パネルでブレークポイント
- Scope パネルで変数が見えるか確認

---

## 8. ページが真っ白（何も表示されない）

### 📋 確認手順

```
┌────────────────────────────────────────┐
│ ステップ1: Console を開く               │
│ 赤いエラーがあるか確認                  │
└────────────────────────────────────────┘
      エラーがある ↓
┌────────────────────────────────────────┐
│ → 最初のエラーを解決する                │
│   （1つ目のエラーが原因で全体が止まる）  │
└────────────────────────────────────────┘
      エラーがない ↓
┌────────────────────────────────────────┐
│ ステップ2: Elements パネルで確認        │
│ <body> の中身があるか                   │
└────────────────────────────────────────┘
      中身がない ↓
┌────────────────────────────────────────┐
│ → HTML ファイルが正しく読み込まれているか│
│   Network パネルで確認                  │
└────────────────────────────────────────┘
```

### 🔍 よくある原因

- JavaScript の初期化エラー（React, Vue など）
- CSS で `body { display: none; }`
- HTML ファイルが空

---

## 9. レイアウトが崩れている

### 📋 確認手順

```
┌────────────────────────────────────────┐
│ ステップ1: Elements パネルで要素を選択  │
│ 崩れている要素をクリック                │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ2: Computed タブを開く          │
│ Box Model を確認                        │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ3: 予想外の margin/padding を   │
│            確認                         │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ4: 親要素のスタイルも確認       │
│ overflow, position などをチェック       │
└────────────────────────────────────────┘
```

---

## 10. ページの読み込みが遅い

### 📋 確認手順

```
┌────────────────────────────────────────┐
│ ステップ1: Network パネルを開く         │
│ → Disable cache にチェック             │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ ステップ2: Time カラムでソート          │
│ 時間がかかっているファイルを特定         │
└────────────────────────────────────────┘
         ↓
┌────────────────────────────────────────┐
│ 原因を特定：                            │
│ • 大きい画像 → 圧縮する                 │
│ • 重い JavaScript → 最適化              │
│ • API が遅い → キャッシュ検討           │
└────────────────────────────────────────┘
```

---

## 🎯 まとめ：問題の種類とパネルの使い分け

| 問題の種類 | 使うパネル | キーワード |
|-----------|-----------|-----------|
| **エラーが出る** | Console | エラーメッセージ、赤色 |
| **要素が見つからない** | Elements | セレクタ、HTML 構造 |
| **CSS が効かない** | Elements (Styles) | 取り消し線、詳細度 |
| **画像が表示されない** | Network | 404, パス |
| **API が失敗** | Network + Console | Status, CORS |
| **ロジックがおかしい** | Sources | ブレークポイント、Step Over |
| **イベントが動かない** | Elements (Event Listeners) | click, イベントリスナー |
| **ページが遅い** | Network | Time, Size |

---

## 💡 デバッグの心得

### 1. 落ち着いて、症状を確認する

- 「何が起きているか」を正確に把握
- エラーメッセージがあれば、まずそれを読む

### 2. 最初のエラーから解決する

- 複数のエラーがある場合、上から順に解決
- 1つ目のエラーが原因で、他のエラーが出ることが多い

### 3. 変更を1つずつ試す

- 複数箇所を同時に変更しない
- どの変更が効果があったか分からなくなる

### 4. 困ったら検索する

- エラーメッセージをコピーして Google 検索
- Stack Overflow、Qiita、MDN が参考になる

### 5. 諦めない

- DevTools を使えば、必ず原因は見つかります！

---

**前へ：** [Sources パネル](./07_sources.md) | **次へ：** [実践演習](./09_exercises.md) | **トップへ：** [README](../README.md)
