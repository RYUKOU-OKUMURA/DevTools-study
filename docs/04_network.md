# Network パネル：通信とリソースの読み込み確認

## 目次
- [Network パネルとは](#network-パネルとは)
- [基本的な見方](#基本的な見方)
- [リソースの種類と色の意味](#リソースの種類と色の意味)
- [ステータスコードの見方](#ステータスコードの見方)
- [実践：よくあるトラブルの確認方法](#実践よくあるトラブルの確認方法)
- [便利な機能](#便利な機能)

---

## Network パネルとは

**Network パネル** は、ページが読み込むすべてのファイルや通信を確認できるパネルです。

### こんな時に使います

- **画像が表示されない**：画像ファイルが正しく読み込まれているか確認
- **API 通信が失敗する**：どんなエラーが返ってきているか確認
- **ページが遅い**：どのファイルの読み込みに時間がかかっているか確認
- **リソースが見つからない**：404 エラーなど、ファイルが存在するか確認

個人開発で **API を使う時** や **画像・CSS・JS ファイルのトラブル** を解決する時に必須です！

---

## 基本的な見方

### Network パネルの開き方

1. DevTools を開く
2. **Network** タブをクリック

**重要：** Network パネルは **開いている間のみ** 記録します！

- パネルを開いてから、ページをリロード（`F5` または `Ctrl + R`）してください
- すでに読み込み済みのリソースは表示されません

### 画面の構成

```
┌─────────────────────────────────────────────────┐
│ 🔴 ⚙️ 🔍 Filter  [All] [XHR] [JS] [CSS] [Img]   │
├──────┬──────┬────────┬──────┬──────┬───────────┤
│ Name │ Stat │ Type   │ Size │ Time │ Waterfall │
├──────┼──────┼────────┼──────┼──────┼───────────┤
│index │ 200  │document│ 5KB  │ 50ms │ ████      │
│style │ 200  │css     │ 2KB  │ 20ms │   ██      │
│main  │ 200  │script  │ 10KB │ 30ms │    ███    │
│logo  │ 404  │png     │ 0KB  │ 10ms │     ❌    │
└──────┴──────┴────────┴──────┴──────┴───────────┘
```

### 各カラムの意味

- **Name**：ファイル名や URL
- **Status**：HTTP ステータスコード（200 = 成功、404 = 見つからない）
- **Type**：リソースの種類（document、script、css、xhr など）
- **Size**：ファイルサイズ
- **Time**：読み込みにかかった時間
- **Waterfall**：読み込みのタイムライン（視覚的に時間を確認できる）

---

## リソースの種類と色の意味

### 主なリソースタイプ

| タイプ | 説明 | 例 |
|--------|------|-----|
| **document** | HTML ページ本体 | `index.html` |
| **stylesheet** | CSS ファイル | `style.css` |
| **script** | JavaScript ファイル | `main.js` |
| **xhr / fetch** | API 通信 | REST API、GraphQL |
| **img** | 画像ファイル | `logo.png`, `photo.jpg` |
| **font** | フォントファイル | `font.woff2` |
| **media** | 動画・音声ファイル | `video.mp4`, `audio.mp3` |

### Waterfall の色の意味

- **薄い色**：待機時間（リクエスト待ち）
- **濃い色**：実際のダウンロード時間
- **赤色のライン**：`DOMContentLoaded` イベント
- **青色のライン**：`load` イベント

---

## ステータスコードの見方

HTTP ステータスコードは、リクエストの結果を示します。

### 成功系（200番台）✅

| コード | 意味 |
|--------|------|
| **200** | OK - 成功 |
| **201** | Created - 作成成功（POST などで使用）|
| **204** | No Content - 成功したが返すデータなし |

### リダイレクト（300番台）↩️

| コード | 意味 |
|--------|------|
| **301** | Moved Permanently - 恒久的な移動 |
| **302** | Found - 一時的な移動 |
| **304** | Not Modified - キャッシュが有効 |

### クライアントエラー（400番台）❌

| コード | 意味 | よくある原因 |
|--------|------|-------------|
| **400** | Bad Request | リクエストの形式が間違っている |
| **401** | Unauthorized | 認証が必要 |
| **403** | Forbidden | アクセス権限がない |
| **404** | Not Found | **ファイルが見つからない**（最頻出！）|
| **405** | Method Not Allowed | HTTP メソッドが間違っている（GET/POST など）|

### サーバーエラー（500番台）⚠️

| コード | 意味 |
|--------|------|
| **500** | Internal Server Error | サーバー側のエラー |
| **502** | Bad Gateway | サーバーが応答しない |
| **503** | Service Unavailable | サーバーが一時的に利用不可 |

---

## 実践：よくあるトラブルの確認方法

### ケース1：画像が表示されない

**確認手順：**

1. Network パネルを開いてページをリロード
2. フィルタで **Img** を選択
3. 画像ファイルを探す
4. Status を確認：
   - **404**：ファイルパスが間違っている
   - **403**：アクセス権限がない
   - **200** だけど表示されない：CSS の `display: none` などを確認

**404 の場合の対処：**

- Name をクリックして、リクエストされている URL を確認
- 実際のファイルパスと比較して修正

### ケース2：API からデータが取得できない

**確認手順：**

1. Network パネルを開く
2. フィルタで **Fetch/XHR** を選択
3. 該当する API リクエストをクリック
4. 右側のパネルで以下を確認：

**Headers タブ：**
- **Request URL**：リクエスト先が正しいか
- **Request Method**：GET / POST などが正しいか
- **Status Code**：200 以外ならエラー

**Preview タブ：**
- サーバーからのレスポンスを確認
- エラーメッセージがあれば読む

**Response タブ：**
- 生のレスポンスデータを確認

**Payload タブ（POST の場合）：**
- 送信したデータが正しいか確認

### ケース3：ページの読み込みが遅い

**確認手順：**

1. Network パネルを開いてリロード
2. **Time** カラムをクリックして、時間順にソート
3. 時間がかかっているファイルを特定：
   - 大きすぎる画像ファイル → 圧縮する
   - 重い JavaScript ファイル → 最適化する
   - 外部 API の遅延 → キャッシュを検討

4. Waterfall を見て、直列に読み込まれているファイルがないか確認

### ケース4：CORS エラーが出る

Console に以下のようなエラーが表示される場合：

```
Access to fetch at 'https://api.example.com' from origin 'http://localhost:3000'
has been blocked by CORS policy
```

**確認手順：**

1. Network パネルで該当リクエストをクリック
2. **Headers** タブを開く
3. **Response Headers** で以下を確認：
   - `Access-Control-Allow-Origin` があるか
   - 自分のオリジンが許可されているか

**対処：**
- サーバー側で CORS 設定を追加する必要があります
- 開発環境なら、プロキシ設定で回避できる場合もあります

---

## 便利な機能

### 1. フィルタで絞り込む

上部のフィルタボタンで、特定の種類のリクエストのみ表示できます：

- **All**：すべて
- **Fetch/XHR**：API 通信のみ
- **JS**：JavaScript ファイルのみ
- **CSS**：CSS ファイルのみ
- **Img**：画像のみ
- **Media**：動画・音声のみ
- **Font**：フォントのみ

### 2. 検索機能

`Ctrl + F`（Mac: `Command + F`）で検索ボックスが表示されます。

ファイル名や URL で検索できるので、特定のリソースを素早く見つけられます！

### 3. ネットワーク速度をシミュレートする

上部の **Online** をクリックすると、接続速度を変更できます：

- **Fast 3G**：3G 回線をシミュレート
- **Slow 3G**：遅い回線をシミュレート
- **Offline**：オフライン状態をテスト

モバイル環境での動作確認に便利です！

### 4. キャッシュを無効にする

Network パネルの上部にある **Disable cache** にチェックを入れると、キャッシュを使わずに毎回サーバーから取得します。

**開発中は常にオンにしておくことをおすすめします！**

理由：キャッシュのせいで、変更が反映されないことがあるため。

### 5. リクエストをコピーする

リクエストを右クリックして、以下をコピーできます：

- **Copy as cURL**：curl コマンドとしてコピー（ターミナルで再現できる）
- **Copy as fetch**：fetch API のコードとしてコピー
- **Copy link address**：URL をコピー

API のテストやデバッグに便利です！

### 6. リクエストを再送する

リクエストを右クリックして **Replay XHR** を選択すると、同じリクエストを再送できます。

API のテストに便利です！

### 7. ファイルサイズの確認

下部のステータスバーに、以下の情報が表示されます：

```
123 requests | 2.5 MB transferred | 3.2 MB resources | Finish: 1.5s | DOMContentLoaded: 800ms | Load: 1.2s
```

- **requests**：リクエストの総数
- **transferred**：実際に転送されたデータ量（圧縮後）
- **resources**：リソースの合計サイズ（圧縮前）
- **Finish**：すべての読み込みが完了した時間

### 8. 保存と読み込み

リクエストを右クリックして **Save all as HAR with content** を選択すると、すべてのリクエストを保存できます。

後で分析したり、他の人と共有したりできます。

---

## まとめ

- Network パネルで、すべての通信とリソース読み込みを確認できる
- パネルを開いてから、ページをリロードする必要がある
- **Status 200** = 成功、**404** = 見つからない、**500** = サーバーエラー
- API のエラーは **Fetch/XHR** フィルタで確認
- **Disable cache** をオンにして開発すると、キャッシュの問題を回避できる
- リクエストをクリックすると、詳細な情報を確認できる

**次へ：** [よくあるエラーと対処法](./05_common_errors.md)
